<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>åŸç”Ÿåˆ†é¡µå®ç°</title>
		<link rel="stylesheet" type="text/css" href="css/style.css"/>
		<script src="lib/jquery.js" type="text/javascript"></script>
	</head>
	<body>
		<table id="my_table" border="1px">
			<thead>
				<tr>
					<th>å§“å</th>
					<th>æ€§åˆ«</th>
					<th>å¹´é¾„</th>
					<th>ä½å€</th>
				</tr>
			</thead>
			<tbody>
				<!--<tr>
					<td>éšè¡Œè€…</td>
					<td>ç”·</td>
					<td>18</td>
					<td>å¹¿å·é»„åŸ”åŒº</td>
				</tr>
				<tr>
					<td>éšè¡Œè€…</td>
					<td>ç”·</td>
					<td>19</td>
					<td>å¹¿å·é»„åŸ”åŒº</td>
				</tr>
				<tr>
					<td>éšè¡Œè€…</td>
					<td>ç”·</td>
					<td>20</td>
					<td>å¹¿å·é»„åŸ”åŒº</td>
				</tr>
				<tr>
					<td>éšè¡Œè€…</td>
					<td>ç”·</td>
					<td>21</td>
					<td>å¹¿å·é»„åŸ”åŒº</td>
				</tr>
				<tr>
					<td>éšè¡Œè€…</td>
					<td>ç”·</td>
					<td>22</td>
					<td>å¹¿å·é»„åŸ”åŒº</td>
				</tr>-->
			</tbody>
		</table>
		<!--================-->
		<!--ä¸Šé¢æ˜¯è¡¨å•éƒ¨åˆ†ï¼Œä¸‹é¢æ˜¯åˆ†é¡µæ§åˆ¶éƒ¨åˆ†-->
		<div class="fenye">
			<a href="###" class="start">é¦–é¡µ</a>
			<a href="###" class="prev"><<ä¸Šä¸€é¡µ</a>
			<!--ä¸ºäº†çµæ´»åœ°å†³å®šè¿™é‡Œçš„aæ ‡ç­¾çš„ä¸ªæ•°ï¼Œé‡‡ç”¨åŠ¨æ€æ·»åŠ çš„æ–¹å¼-->
			<!--<a href="###" name="p" style="background-color: orange;color: #FFFFFF;">1</a>
			<a href="###" name="p">2</a>
			<a href="###" name="p">3</a>
			<a href="###" name="p">4</a>
			<a href="###" name="p">5</a>-->
			
			<a href="###" class="next">ä¸‹ä¸€é¡µ>></a>
			<a href="###" class="end">å°¾é¡µ</a>
		</div>
	</body>
	<script type="text/javascript">
		/**
		 * ã€åŸç”Ÿåˆ†é¡µå®ç°çš„æ€è·¯(åŸç†)ã€‘é¦–å…ˆå’Œäº§å“ç»ç†ç¡®å®šä¸€ä¸‹æ¯é¡µæ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®
		 * ç„¶åé€šè¿‡åå¤©çš„æ•°æ®æ¥å£è·å–æŸä¸€é¡µçš„æ•°æ®(åˆ°åº•ç¬¬å“ªä¸€é¡µéœ€è¦ç»™è¿™ä¸ªæ¥å£)
		 * ä¼ å…¥ä¸€ä¸ªè¡¨ç¤ºé¡µç çš„å‚æ•°ã€‚ç„¶åè€ƒè™‘å¦‚ä½•æ˜¾ç¤ºæ•°æ®ã€‚
		 * æœ¯è¯­ï¼šé¡µç ã€æ¯é¡µæ˜¾ç¤ºæ¡ç›®ã€æ•°æ®æ€»æ•°ã€æ¯é¡µæ•°æ®åˆ—è¡¨
		 * å…¶ä¸­æ¯é¡µæ˜¾ç¤ºæ¡ç›®æ˜¯åŠ¨æ€çš„ï¼ˆæš‚å®š5æ¡ï¼‰
		 * æ•°æ®æ€»æ•°æ˜¯æ¥å£æä¾›çš„ã€‚é¡µç æ•°éœ€è¦æ ¹æ®æ•°æ®æ€»æ•°å’Œæ¯é¡µæ˜¾ç¤ºçš„æ¡ç›®æ•°å»è®¡ç®—çš„
		 * æ€»é¡µç æ•° = æ€»æ•°æ®æ¡æ•° / æ¯é¡µæ•°æ®æ¡æ•°
		 * ï¼Ÿ =  28 / 5
		 */
		// ä¸ºäº†å…¨å±€ç¼“å­˜æ‰€æœ‰çš„æ•°æ®
		var personsList = null
		// å…¨å±€ç¼“å­˜æ•°æ®æ€»æ¡æ•°
		var totalCount = 0
		// å½“å‰é¡µç 
		var currentPageNo = 1
		// ä»»åŠ¡1ï¼šè®¡ç®—æœ‰å¤šå°‘é¡µ(ä»¥ä¾¿åˆå§‹åŒ–æŒ‰é’®)
		function initBtn(){
			// é€šè¿‡jQçš„getJSONæ–¹æ³•è·å–æ•°æ®
			// å‚æ•°2ï¼šæ˜¯è¿åŒè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ï¼Œnullå³æ— 
			$.getJSON("data.json", null, function(resultData){
				// resultDataæ˜¯è§£æå‡ºæ¥çš„Jsonå¯¹è±¡
				//console.log(resultData)
				
				/**
				 * æŠŠè·å–åˆ°çš„æ•°æ®ç¼“å­˜åˆ°æœ¬åœ°ï¼špersonså’ŒtotalCount
				 */
				personsList = resultData.persons
				totalCount = resultData.totalCount
				// åŠ¨æ€æ·»åŠ ã€å…±XXé¡µã€‘æŒ‰é’®
				var $all = $('<a href="###" style="width:80px">' + 'å…±' + Math.ceil(totalCount / 5) + 'é¡µ' + '</a>')
				$('.prev').after($all)
				// é¡µç æ•°(é¡µç æŒ‰é’®ä¸ªæ•°) = å‘ä¸Šå–æ•´(æ•°æ®æ€»æ•° / æ¯é¡µæ¡ç›®) (é»˜è®¤5æ¡)
				for(var i = Math.ceil(totalCount / 5); i >= 1; i--){
					// åŠ¨æ€åˆ›å»ºé¡µç æŒ‰é’®
					var $a = $('<a href="###" name="p">' + i +  '</a>')
					if(i == 1){
						$a.css({
							background: 'orange',
							color: '#fff'
						})
					}
					/**
					 * åˆ›å»ºä¸€ä¸ªaæ ‡ç­¾å°±æ’å…¥åˆ°ã€ä¸Šä¸€é¡µã€‘å…ƒç´ ä¹‹åï¼Œåˆ†åˆ«æ˜¯ï¼š
					 * prev 1 2 3 4 5 next end
					 * éœ€è¦å…ˆæ’5ï¼Œæ‰€ä»¥ã€é€†åºéå†ã€‘
					 */
					// ã€$('.prev').after($a)ã€‘çš„æ„æ€æ˜¯æŠŠXXæ’å…¥åˆ°prevå…ƒç´ ä¹‹å
					$('.prev').after($a)
				}
				// ç»™æ‰€æœ‰çš„æŒ‰é’®ç»‘å®šäº‹ä»¶
				$('.fenye a').on('click', fenyeFn)
				// é»˜è®¤æ˜¾ç¤ºç¬¬ä¸€é¡µçš„æ•°æ®
				showData(currentPageNo)
			})
		}
		// å‡½æ•°è°ƒç”¨
		initBtn()
		
		// æ„å»ºæŸä¸€é¡µçš„æ•°æ®  pageNo = 3
		function showData(pageNo){
			/**
			 * ç¬¬1é¡µï¼š0--4
			 * ç¬¬2é¡µï¼š5--9
			 * ç¬¬3é¡µï¼š10--14
			 * ç¬¬4é¡µï¼š15--19
			 * ç¬¬5é¡µï¼š20--22
			 */
			// arrayObject.slice(start, end)æ–¹æ³•å¯ä»¥ä»å·²æœ‰çš„æ•°ç»„ä¸­è¿”å›é€‰å®šçš„å…ƒç´ ,è¿”å›ä¸€ä¸ªæ–°çš„
			//æ•°ç»„ï¼ŒåŒ…å«ä»startåˆ°end(ä¸åŒ…æ‹¬è¯¥å…ƒç´ )çš„arrayObjectä¸­çš„å…ƒç´ 
			// currentArræ•°ç»„çš„æ¯ä¸ªå…ƒç´ tempPersonä»£è¡¨ä¸€ä¸ªäººçš„ä¿¡æ¯
			var currentArr = personsList.slice((pageNo - 1) * 5, pageNo * 5)
			console.log(currentArr)
			// åŠ¨æ€åˆ›å»ºæŸä¸€é¡µçš„æ ‡ç­¾
			var $str = ''
			for(var tempPerson of currentArr){
				/*<tr>
					<td>éšè¡Œè€…</td>
					<td>ç”·</td>
					<td>18</td>
					<td>å¹¿å·é»„åŸ”åŒº</td>
				</tr>*/
				$str += '<tr>'
				for(var tempProp in tempPerson){
					//console.log(tempProp)
					/**
					 * ã€ğŸ·ã€‘for...inéå†åˆ°çš„æ˜¯é”®å€¼å¯¹çš„ã€é”®ã€‘(è€Œä¸æ˜¯å€¼)
					 */
					$str += '<td>' + tempPerson[tempProp] + '</td>'
				}
				$str += '</tr>'
			}
			// æŠŠ$strä½œä¸ºtbodyçš„html
			$('tbody').html($str)
		}
		// ä»»åŠ¡2ï¼šåˆ†é¡µæŒ‰é’®ç‚¹å‡»é€»è¾‘
		function fenyeFn(){
			// å¾—åˆ°å…ƒç´ çš„htmlçš„å€¼
			//console.log("æŒ‰é’®ä¸Šçš„æ–‡å­—æ˜¯ï¼š" + $(this).html())
			// 1ã€å¤„ç†é¡µç æ•°çš„é€»è¾‘ï¼šç‚¹å‡»åï¼ŒcurrentPageNoçš„å€¼è¢«æ”¹å˜äº†
			switch($(this).html()){
				case 'é¦–é¡µ':
					currentPageNo = 1
					break
				case '&lt;&lt;ä¸Šä¸€é¡µ':
					currentPageNo--
					break
				case 'ä¸‹ä¸€é¡µ&gt;&gt;':
					currentPageNo++
					break
				case 'å°¾é¡µ':
					currentPageNo = Math.ceil(totalCount / 5)
					break
				default:
					currentPageNo = parseInt($(this).html())
					break
			}
			console.log("å½“å‰é¡µæ˜¯ï¼š" + currentPageNo)
			//===========================
			//2ã€é¦–å°¾ã€ä¸Šä¸‹æŒ‰é’®çš„éšè—æ˜¾ç¤ºé€»è¾‘
			if(currentPageNo == 1){
				$('.start').css('display', 'none')
				$('.prev').css('display', 'none')
			}else{
				$('.start').css('display', 'inline-block')
				$('.prev').css('display', 'inline-block')
			}
			// å¦‚æœæ˜¯æœ€åä¸€é¡µ
			if(currentPageNo == Math.ceil(totalCount / 5)){
				$('.end').css('display', 'none')
				$('.next').css('display', 'none')
			}else{
				$('.end').css('display', 'inline-block')
				$('.next').css('display', 'inline-block')
			}
			// 3ã€å¤„ç†æŒ‰é’®é¢œè‰²çš„é€»è¾‘
			//è·å–å…¨éƒ¨é¡µç æŒ‰é’®çš„æ•°ç»„
			var $pageBtn = $('[name=p]')
			//å…ˆæŠŠè¿™å‡ ä¸ªæŒ‰é’®çš„æ ·å¼è¿˜åŸæˆé»˜è®¤
			$pageBtn.css({
				background: "pink",
				color: "#999"
			})
			// ç„¶åå†å¤„ç†å½“å‰é¡µç æ•°å¯¹åº”çš„æŒ‰é’®æ ·å¼
			$pageBtn[currentPageNo - 1].style.background = 'orange'
			$pageBtn[currentPageNo - 1].style.color = '#fff'
			// åˆ·æ–°æ•°æ®
			showData(currentPageNo)
		}
	</script>
</html>
